{% extends 'layout.html' %}

{% block title %}
    Constructor
{% endblock %}

{% block tabs %}
    <ul class="nav nav-tabs nav-fill">
        <li class="nav-item">
            <a class="nav-link" href="/constructor">Fixed-Weight</a>
        </li>
        <li class="nav-item">
            <a class="nav-link active" aria-current="page" href="/constructorIV">Inverse-Volatility</a>
        </li>
        <li class="nav-item">
            <a class="nav-link" href="constructorRB">Risk-Budget</a>
        </li>
    </ul>
{% endblock %}

{% block alerts %}
    {% for error in errors %}
        <!-- https://getbootstrap.com/docs/5.3/components/alerts/ -->
        <div class="alert alert-warning" role="alert">
            {{ error }}
        </div>
    {% endfor %}
{% endblock %}

{% block body %}
    <form action="/constructorIV" method="post">
        <!-- https://getbootstrap.com/docs/5.3/components/accordion/ -->
        <div class="accordion" id="accordionConstructor">
            <div class="accordion-item">
                <h2 class="accordion-header">
                    <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#panelsStayOpen-collapseOne" aria-expanded="false" aria-controls="panelsStayOpen-collapseOne">Select Range</button>
                </h2>
                <div id="panelsStayOpen-collapseOne" class="accordion-collapse collapse show">
                    <div class="accordion-body">
                        <div class="input-group w-50 mx-auto">
                            <span class="input-group-text">Start Date</span>
                            <input type="date" aria-label="StartDate" name="StartDate" class="form-control"> 
                            <span class="input-group-text">End Date</span>
                            <input type="date" aria-label="EndDate" name="EndDate" class="form-control"> 
                        </div>            
                    </div>
                </div>
            </div>
            <div class="accordion-item">
                <h2 class="accordion-header">
                    <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#panelsStayOpen-collapseTwo" aria-expanded="false" aria-controls="panelsStayOpen-collapseTwo">Select Tickers</button>
                </h2>
                <div id="panelsStayOpen-collapseTwo" class="accordion-collapse collapse show">
                    <div class="accordion-body text-center">
                        {% for ticker in range(portfolio_n) %}
                            <div class="input-group mb-3 w-75 mx-auto">
                                <div class="input-group-text">
                                    <input class="form-check-input mt-0" type="checkbox" name="AddTicker{{loop.index}}" aria-label="Checkbox for following text input" {% if loop.index <= checked_n %}checked{% endif %}>
                                </div>    
                                <span class="input-group-text">Ticker {{loop.index}}</span>
                                <input type="text" aria-label="Ticker" placeholder="AAPL" name="Ticker{{loop.index}}" class="form-control">
                            </div>
                        {% endfor %}
                    </div>
                </div>
            </div>
            <div class="accordion-item">
                <h2 class="accordion-header">
                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#panelsStayOpen-collapseThree" aria-expanded="false" aria-controls="panelsStayOpen-collapseThree">Extra Settings</button>
                </h2>
                <div id="panelsStayOpen-collapseThree" class="accordion-collapse collapse">
                    <div class="accordion-body">
                        <!-- https://getbootstrap.com/docs/5.3/forms/checks-radios/ -->
                        <div class="input-group w-75 mx-auto"> 
                            <span class="input-group-text">Volatility Lookback Window</span>
                            <input type="number" aria-label="Volatility Lookback Window (Days)" name="VolLookbackWindow" class="form-control" step="1" min="1" placeholder="20"> 
                            <span class="input-group-text">Volatility Lookback Offset</span>
                            <input type="number" aria-label="Volatility Lookback Offset (Days)" name="VolLookbackOffset" class="form-control" step="1" min="1" placeholder="1">
                            <!-- https://getbootstrap.com/docs/5.3/forms/select/  -->
                            <span class="input-group-text">Rebalancing Frequency</span>
                            <select class="form-select" aria-label="Rebalancing Frequency" name="RebalFreq">
                                <option value="B" selected>Daily</option>
                                <option value="Q">Quarterly</option>
                                <option value="M">Monthly</option>
                                <option value="W">Weekly</option>
                            </select>
                            <span class="input-group-text">Ignore Missing</span>
                            <select class="form-select" aria-label="Ignore Missing" name="IgnoreMissing">
                                <option value="False" selected>No</option>
                                <option value="True">Yes</option>
                            </select>
                        </div>  
                    </div>
                </div>
            </div>
        </div>
        <br>
        <div class="container-fluid text-center">        
            <button class="btn btn-primary" type="submit">Run Backtest</button>
        </div>
    </form>
{% endblock %}